# **CPU의 기본 구조와 역할**

## 1️⃣ CPU란 무엇인가? 왜 중요한가?

- 명령어를 해석, 처리, 실행
- 입력 데이터를 처리하여 출력 정보를 생성
- 운영체제와 애플리케이션 실행을 위한 모든 계산 및 제어 작업을 담당

  

## 2️⃣ CPU 내부 구성 요소

### **ALU (산술 논리 연산 장치)**

- 산술 연산(덧셈, 뺄셈 등) 및 논리 연산(AND, OR, NOT 등)을 수행합니다.
- 데이터를 처리하고, 결과를 생성하고 CPU내부 레지스터 또는 메모리에 저장

### **CU (제어 장치)**

- 명령어를 해석하고 CPU 내부 및 외부 장치 간 데이터 흐름을 관리합니다.
- 명령어를 디코딩하여 필요한 작업을 지시하고, CPU의 다른 구성 요소를 조정합니다

### **레지스터(Register)**

- 고속 메모리로, 현재 작업 중인 데이터를 임시 저장합니다.
- 주소 레지스터
    - 스택 포인터(SP): CPU는 현재 실행하고 있는 프로그램의 메모리 영역을 스택으로 관리
        - SP는 현재 스택 영역에서 가장 마지막 부분(가장 최근에 저장된)을 가르킴
    - 베이스 포인터(BP, Base Potiner)
        - BP는 스택 영역에서 각 메모리 영역의 경계선을 가르킴
        - 즉, 서브루틴 호출 시에 Caller의 SP는 BP가 됨
        - 서브루틴의 실행이 완료되면 BP는 다시 SP가 됨
    - 인덱스 레지스터(IX, Index Register)
        - 배열에 순차적으로 접근하기 위한 레지스터
- 제어용 레지스터
    - 프로그램 카운터(PC): 다음에 실행할 명령어의 주소를 저장.
    - 명령어 레지스터(IR): 가장 최근에 실행한 명령어를 보관
    - 누산기(ACC): 계산 결과를 저장.
    - 메모리 주소 레지스터(MAR): 읽거나 쓸 메모리 주소를 저장.
    - 메모리 데이터 레지스터(MDR / MBR): 읽거나 쓸 데이터를 저장

---

### 기타 내부 장치

**내부 CPU 버스**

- ALU ↔ 레지스터, ALU ↔ 제어장치, 제어장치 ↔ 레지스터간의 데이터 이동
- CPU 밖의 시스템 버스들과 직접 연결 X
- 버퍼 레지스터 / 인터페이스 유닛을 통해 시스템 버스와 접속 됨

  

**캐시(Cache)**

- CPU와 메인 메모리 간의 데이터 속도 향상을 위한 중간 버퍼 역할을 해주는 CPU 내부에 존재하는 메모리입니다.
- Ram보다 빠른 고속 메모리, 자주 사용되는 데이터와 명령어를 임시 저장하여 처리 속도를 높입니다

# CPU의 작동원리

1. **주기억장치가** 입력장치에서 **입력받은 데이터** 또는 **보조기억장치에 저장된 프로그램**을 읽어온다
2. **CPU**는 프로그램을 실행하기 위해 **주기억장치에 저장된 프로그램 명령어**와 **데이터를 읽어와 처리**하고 **결과를 다시 주기억 장치에 저장**한다
3. **주기억장치**는 **처리 결과를 보조기억장치에 저장**하거나 **출력장치로 보내서 출력**시킨다
4. **CPU** 내의 **제어장치**가 1~3번 과정에서 명령어가 순서대로 실행되도록 **각 장치들을 제어**한다

  

- 명령어 사이클 (Fetch → Decode → Execute → Writeback)
    1. 명령어 가져오기(Fetch): 메모리에서 명령어를 Cpu로 가져옵니다.
    2. 명령어 해석하기(Decode): 제어 장치가 명령어를 분석하고 필요한 작업을 결정합니다.
    3. 명령어 실행하기(Execute): ALU 또는 다른 구성 요소가 작업을 수행하며 결과를 저장하거나 출력합니다
    4. 결과 저장하기(Writeback): 실행결과를 저장합니다.  
        

  

- 클럭(Clock)
    - CPU내부에서 일정한 주파수를 가지는 신호, 이 신호에 따라 명령어가 동작
    - 클럭이 빠를수록 더 많은 명령어 처리 가능
- IPC(Instruction Per Cycle)
    
    - 1회의 Clock당 완료되는 명령어의 수
    - 현재 가장 신뢰성이 있는 CPU 성능 지표
    
    > [!important] **⚠️ “IPC와 Performance Per Watt는 어떻게 다른가요?”**
    > 
    > IPC는 CPU가 클럭 한 사이클당 얼마나 많은 명령어를 실행할 수 있는지를 나타내는 아키텍처 효율성 지표입니다.
    > 
    > 반면, Performance per Watt는 같은 전력을 소비했을 때 얼마나 많은 작업을 수행할 수 있는지를 나타내며, 전력 효율성을 판단할 때 사용됩니다.
    > 
    > 예를 들어, 서버나 모바일 CPU에서는 IPC보다 Performance per Watt가 더 중요한 척도일 수 있습니다.
    
- 코어(Core)
    - 코어란 ALU, 컨트롤유닛, 레지스터로 구성된 CPU의 동작을 할 수 있는 장치를 의미
    - 명령어의 연산을 병렬로 수행 가능
- 쓰레드(Thread)의 개념
    - 한 프로세스 내에서 동작되는 여러 실행의 흐름
    - 같은 프로세스의 스레드들은 같은 힙 공간을 공유, 프로세스는 다른 프로세스의 메모리에 접근 불가
    - 각각의 스레드는 별개의 레지스터와 스택을 갖지만, 힙 메모리는 서로 공유

  

# 시스템 버스

![[Attachments/img1.daumcdn 2.png|img1.daumcdn 2.png]]

- 컴퓨터의 구성요소(CPU, 메모리, 입출력장치)를 서로 연결하고 데이터 전달을 위한 경로

  

## 주소버스**(Address Bus)**

- 메모리의 주소나 입출력 유닛의 포트번호를 전달
- CPU와 Memory는 단방향으로 데이터 전달이 가능한 버스를 이용함으로써 주소 전달은 CPU에서 메모리로만 가능
- CPU, Memory는 I/O Unit과 양방향으로 데이터 전달이 가능한 버스를 사용

## **데이터 버스(Data Bus)**

- 데이터 값 전달
- 각 구성요소(CPU, Memory, I/O Unit)는 양방향으로 데이터 전달이 가능한 버스를 사용

## **제어 버스(Control Bus)**

- 제어 신호 전달
- **CPU ↔ 메모리 ↔ I/O 장치 간의 동작을 조율**하기 위한 신호 선
- Read와 Write, 인터럽트 신호 전달
- 각 구성요소(CPU, Memory, I/O Unit)는 양방향으로 데이터 전달이 가능한 버스를 사용

> [!important] **⚠️ “제어 버스에서 인터럽트와 메모리 읽기 신호는 어떻게 다르나요?”**
> 
> 인터럽트는 주변 장치가 CPU에 요청을 보내기 위해 제어 버스를 사용하는 입력 신호이고,
> 
> 메모리 읽기 신호는 CPU가 메모리로부터 데이터를 가져오기 위해 제어 버스를 통해 내보내는 출력 신호입니다.
> 
> 두 신호 모두 제어 버스를 통해 전달되지만, 방향성과 목적이 다릅니다.

  

# **컴퓨터 구성 요소간 통신**

### **CPU ↔ 메모리**

- 적재(Load)와 저장(Store) 명령에 의해 수행

(1) 적재(Load)

- 주소 버스 : 메모리에서 불러올 데이터가 저장된 주소값이 전달(CPU -> Memory)
- 신호 버스 : Memory Read 신호 전달(CPU -> Memory)
- 데이터 버스 : 지정한 메모리에 저장된 값 전달(Memory -> CPU)

(2) 저장(Store)

- 주소 버스 : 메모리에서 해당 데이터를 저장할 주소값 전달(CPU -> Memory)
- 신호 버스 : Memory Write 신호 전달(CPU -> Memory)
- 데이터 버스 : 저장할 데이터 전달(CPU -> Memory)

  

### **CPU ↔ I/O Unit**

- 입력(Input)과 출력(Output)명령에 의해 수행

(1) 입력(Input)

- 주소 버스 : 해당 입출력 장치의 포트 번호 전달(CPU -> I/O Unit)
- 신호 버스 : I/O Read(input) 신호 전달(CPU -> I/O Unit)
- 데이터 버스 : 해당 입출력 장치는 데이터 전달(I/O Unit -> CPU)

(2) 출력(Output)

- 주소 버스 : 해당 입출력 장치의 포트 번호 전달(CPU -> I/O Unit)
- 신호 버스 : I/O Write(output) 신호 전달(CPU -> I/O Unit)
- 데이터 버스 : 입출력 장치에 데이터 전달(CPU -> I/O Unit)

(3) 인터럽트(Inputerrupt)

- 입출력장치는 제어신호를 통해 인터럽트 요청을 보내 CPU에 입출력작업을 요청할 수 있음
- 인터럽트 요청 : 입출력 준비를 마친 I/O Unit이 CPU에 입출력작업의 시작 요청
- 인터럽트 확인 : CPU가 입추력 동작을 수행할 것을 입출력장치에 통보

  

### **메모리 ↔ I/O Unit**

- 입출력장치와 메모리의 통신은 CPU를 이용하지 않고 **직접 기억장치 액세스 방식(DMA, Direct Memory Access)**으로 통신
- DMA 제어기는 CPU를 대신해 주소 버스와 제어버스에 신호를 전달
- DMA 제어기는 통신 시작 전 CPU에 버스 사용해 대한 허가를 받아야함

  

---

**4️⃣ 성능 최적화와 병렬성**

멀티코어, 하이퍼스레딩(Hyper-threading)

Instruction Level Parallelism (ILP)

CPU Bottleneck 원인과 해결 방향

Branch Prediction, Speculative Execution